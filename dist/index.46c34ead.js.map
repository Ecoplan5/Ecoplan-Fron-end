{"mappings":"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","sources":["src/js/home.js"],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n  cargarDatosUsuario(); // Llamar directamente a cargarDatosUsuario como función principal\n});\n\n\nfunction cargarDatosUsuario() {\n\n  const usuario = localStorage.getItem(\"usuario\");\n  const token = localStorage.getItem(\"token\");\n\n  // Si no existen datos, redirige al login\n  if (!usuario || !token) {\n    console.log(\"No se encontró usuario o token. Redirigiendo a landing...\");\n    if (window.location.pathname !== \"/landing.html\") {\n      window.location.href = \"landing.html\"; // Redirige a la página de bienvenida\n    }\n    return;\n  }\n\n  // Parsear el objeto usuario desde JSON\n  const user = JSON.parse(usuario);\n\n  // Actualizar el nombre del usuario en el DOM\n  const nombreUsuario = document.getElementById(\"usuario\");\n\n  if (nombreUsuario && user.nombre_usuario) {\n    nombreUsuario.textContent = user.nombre_usuario;\n  }\n\n  // Continuar con la lógica de redirección\n  if (window.location.pathname === \"/login.html\" && usuario && token) {\n    console.log(\"Usuario autenticado. Redirigiendo a index.html...\");\n    window.location.href = \"index.html\";\n    return;\n  }\n\n  if (window.location.pathname === \"/landing.html\" || window.location.pathname === \"/login.html\") {\n    console.log(\"Usuario autenticado. Redirigiendo a index.html...\");\n    window.location.href = \"index.html\";\n    return;\n  }\n\n  if (window.location.pathname === \"/index.html\") {\n    console.log(\"Ya estás en index.html.\");\n    return;\n  }\n\n  console.log(\"Usuario validado correctamente. Redirigiendo a index.html...\");\n  window.location.href = \"index.html\";\n}\n\n\n/**\n * Función para mostrar el modal y cargar los datos del usuario\n */\nfunction updateContactInfo() {\n  const usuarioData = localStorage.getItem(\"usuario\");\n  if (!usuarioData) {\n    console.error(\"No se encontró información del usuario en localStorage\");\n    return;\n  }\n\n  const usuario = JSON.parse(usuarioData);\n  mostrarUsuario(usuario);\n\n  // Mostrar el modal\n  const modal = document.getElementById(\"modalActualizarContacto\");\n  modal.style.display = \"flex\";\n}\n\n/**\n * Función para cerrar el modal\n */\nfunction cerrarModal() {\n  const modal = document.getElementById(\"modalActualizarContacto\");\n  modal.style.display = \"none\";\n}\n// Cambiar la visibilidad de las contraseñas en el formulario\ndocument.getElementById(\"verYocultarContrasena\").addEventListener(\"change\", function () {\n  const passwordInputs = document.querySelectorAll('input[type=\"password\"], input[type=\"text\"]');\n  \n  passwordInputs.forEach((input) => {\n    // Cambia el tipo según el estado del checkbox\n    input.type = this.checked ? \"text\" : \"password\";\n  });\n});\n\n\n// Función para manejar el cambio de archivo (selección de imagen)\nasync function handleFileChange(event) {\n  const file = event.target.files[0];\n  if (file) {\n    try {\n      const formData = new FormData();\n      formData.append('foto', file);\n\n      // Obtener ID de usuario del localStorage o desde userInfo\n      const userId = localStorage.getItem('userId') || (await getUserInfo()).id_usuario;\n      formData.append('id_usuario', userId);\n\n      // Seleccionar endpoint según el usuario\n      const endpoint = userName === 'Admin'\n        ? 'http://localhost:8095/api/upload/admin-profile'\n        : 'http://localhost:8095/api/upload/empleado-profile';\n\n      const response = await fetch(endpoint, {\n        method: 'POST',\n        body: formData,\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem('token')}`,\n        },\n      });\n\n      const data = await response.json();\n      if (response.ok) {\n        const fullUrl = `http://localhost:8095/uploads/${data.filePath}`;\n        setProfileImage(fullUrl);\n\n        // Convertir la imagen a base64 y almacenarla\n        const reader = new FileReader();\n        reader.onloadend = () => {\n          const base64Image = reader.result;\n          localStorage.setItem('profileImage', base64Image); // Guardar en localStorage\n          setProfileImage(base64Image); // Actualizar la imagen en el frontend\n        };\n        reader.readAsDataURL(file);\n\n        Swal.fire('Imagen actualizada', 'La imagen de perfil ha sido actualizada con éxito', 'success');\n      } else {\n        Swal.fire('Error', data.message || 'Error al subir la imagen', 'error');\n      }\n    } catch (error) {\n      console.error('Error al subir la imagen:', error);\n      Swal.fire('Error', 'Error al subir la imagen', 'error');\n    }\n  }\n};\n\n// Función para activar el input de archivo// Función para activar el input de archivo\n\n\n// Función que se activa cuando haces clic en el ícono de \"Cargar imagen\"\nfunction uploadImage() {\n  const fileInput = document.getElementById(\"fileInput\");\n  fileInput.click();  // Esto abre el cuadro de selección de archivos\n}\n\n// Función para manejar el cambio cuando un archivo es seleccionado\nfunction handleFileChange(event) {\n  const file = event.target.files[0];  // Obtiene el primer archivo seleccionado\n  if (file) {\n    console.log(\"Archivo seleccionado: \", file.name);\n    // Aquí puedes agregar el código para cargar o procesar el archivo\n  }\n}\n\n\n\n/**\n * Función para mostrar los datos del usuario en el formulario\n */\nfunction mostrarUsuario(usuario) {\n  document.getElementById(\"nombre_usuario\").value = usuario.nombre_usuario || \"\";\n  document.getElementById(\"email\").value = usuario.email || \"\";\n};\n\nasync function actualizarUsuario() {\n  const nombre_usuario = document.getElementById(\"nombre_usuario\").value;\n  const email = document.getElementById(\"email\").value;\n  const contrasena = document.getElementById(\"contrasena\").value;\n\n  const usuarioData = JSON.parse(localStorage.getItem(\"usuario\"));\n  const data = {\n    id_usuario: usuarioData.id_usuario,\n    nombre_usuario,\n    email,\n    contrasena,\n  };\n\n  const token = localStorage.getItem(\"token\");\n  if (!token) {\n    Swal.fire(\"Error\", \"Token de autenticación no encontrado\", \"error\");\n    return;\n  }\n\n  try {\n    const response = await fetch(\"http://localhost:8092/api/actualizarPerfil\", {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (response.ok) {\n      Swal.fire(\"Éxito\", \"Datos actualizados correctamente\", \"success\");\n      cerrarModal();\n    } else {\n      const errorData = await response.json();\n      const mensajeError = errorData.mensaje || \"Error desconocido\";\n      Swal.fire(\"Error\", mensajeError, \"error\");\n    }\n  } catch (error) {\n    console.error(error);\n    Swal.fire(\"Error\", \"No se pudo conectar con el servidor. Inténtalo más tarde.\", \"error\");\n  }\n}\n\n// Función para mostrar/ocultar el menú desplegable\nfunction toggleDropdown() {\n  const menu = document.getElementById(\"dropdownMenu\");\n  menu.classList.toggle(\"active\");\n}\n\n\n\n\n// Función para cerrar sesión\nfunction logout() {\n  console.log(\"Cerrando sesión...\");\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"usuario\");\n  window.location.href = \"login.html\";\n}\n\n// Cierra el menú al hacer clic fuera\ndocument.addEventListener(\"click\", function (event) {\n  const dropdown = document.getElementById(\"dropdownMenu\");\n  const avatarContainer = document.querySelector(\".avatar-container\");\n  if (\n    dropdown &&\n    avatarContainer &&\n    !avatarContainer.contains(event.target) &&\n    !dropdown.contains(event.target)\n  ) {\n    dropdown.classList.remove(\"active\");\n  }\n});\n"],"names":[],"version":3,"file":"index.46c34ead.js.map","sourceRoot":"/__parcel_source_root/"}